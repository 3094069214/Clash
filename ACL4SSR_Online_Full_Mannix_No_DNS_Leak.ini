[custom]

exclude_remarks=(Data Left|Remain:|Traffic:|Expir[ey]|Reset|(\d[\d.]*\s*[MG]B[^\dA-Za-z]+|[:：]\s*)\d[\d.]*\s*GB(?![\dA-Za-z])|剩[余餘]流量|流量：|[到过過效]期|[时時][间間]|重置|分割线|残り使用容量|有効期限|リセット|🔰 (ID|HSD|SNI):|📝 Gói:)

add_emoji=true
remove_old_emoji=false
emoji=(?!🇨🇳)[🇦-🇿]{2},
emoji=^(?!.*[🇦-🇿]{2}).*(美国|华盛顿|波特兰|达拉斯|俄勒冈|凤凰城|费利蒙|硅谷|旧金山|拉斯维加斯|洛杉矶|圣何塞|圣克拉拉|西雅图|芝加哥|纽约|丹佛|加利福尼亚|弗吉尼亚|得克萨斯|亚特兰大|佛罗里达|迈阿密|United States|Washington|Portland|Dallas|Oregon|Phoenix|Fremont|Silicon Valley|San Francisco|Las Vegas|Los Angeles|San Jose|Santa Clara|Seattle|Chicago|New York|Denver|California|Virginia|Texas|Atlanta|Florida|Miami),🇺🇸
emoji=^(?!.*[🇦-🇿]{2}).*(香港|Hong Kong),🇭🇰
emoji=^(?!.*[🇦-🇿]{2}).*(日本|东京|大阪|名古屋|埼玉|福冈|Japan|Tokyo|Osaka|Nagoya|Saitama|Fukuoka),🇯🇵
emoji=^(?!.*[🇦-🇿]{2}).*(新加坡|Singapore),🇸🇬
emoji=^(?!.*[🇦-🇿]{2}).*(台湾|台北|新北|彰化|高雄|Taiwan|Taipei|New Taipei|Changhua|Kaohsiung),🇹🇼
emoji=^(?!.*[🇦-🇿]{2}).*(英国|英格兰|伦敦|曼彻斯特|United Kingdom|England|London|Manchester),🇬🇧
emoji=^(?!.*[🇦-🇿]{2}).*(加拿大|多伦多|蒙特利尔|温哥华|Canada|Toronto|Montreal|Vancouver),🇨🇦
emoji=^(?!.*[🇦-🇿]{2}).*(德国|法兰克福|柏林|Germany|Frankfurt|Berlin),🇩🇪
emoji=^(?!.*[🇦-🇿]{2}).*(法国|巴黎|France|Paris),🇫🇷
emoji=^(?!.*[🇦-🇿]{2}).*(韩国|首尔|South Korea|Seoul),🇰🇷
emoji=^(?!.*[🇦-🇿]{2}).*(澳大利亚|悉尼|墨尔本|Australia|Sydney|Melbourne),🇦🇺
emoji=^(?!.*[🇦-🇿]{2}).*(俄罗斯|莫斯科|圣彼得堡|Russia|Moscow|Saint Petersburg),🇷🇺
emoji=^(?!.*[🇦-🇿]{2}).*(中国|深圳|北京|上海|广东|山东|湖北|湖南|天津|重庆|辽宁|吉林|黑龙江|江苏|浙江|安徽|福建|云南|四川|陕西|甘肃|青海|内蒙古|西藏|宁夏|新疆|China|Shenzhen|Beijing|Shanghai|Guangdong|Shandong|Hubei|Hunan|Tianjin|Chongqing|Liaoning|Jilin|Heilongjiang|Jiangsu|Zhejiang|Anhui|Fujian|Yunnan|Sichuan|Shaanxi|Gansu|Qinghai|Inner Mongolia|Tibet|Ningxia|Xinjiang),🇨🇳
emoji=^(?!.*([🇦-🇿]{2}|ℹ️)).*(官.?网|官方|产品|平台|勿连|修复|恢复|更新|地址|网站|网址|域名|网域|浏览器|导航|搜|群|裙|聊|频道|电报|飞机|扣|微信|售后|客服|工单|联系|使用|购买|续费|订阅|公告|版本|出现|没网|情况|开通|数量|注|说明|通知|去除|过滤|@|：|(?i:(?<![\da-z])(tg|telegram|t\.me|qq?|vx?|wx)(?!\d*[a-z]|\d{1,3}(?!\d))|^[^:]+:(?![\da-f]{0,4}:|\s*\d{1,5}([/?]|\s*$)))),ℹ️

enable_rule_generator=true
overwrite_original_rules=true

custom_proxy_group=✈️起飞`select`[]⚡低延迟`[]🇭🇰香港`[]🇹🇼台湾`[]🇸🇬新加坡`[]🇯🇵日本`[]🇺🇸美国`[]🎏其他`[]👆🏻指定`[]DIRECT`[]REJECT
custom_proxy_group=⚡低延迟`url-test`.*`https://www.gstatic.com/generate_204`180,,50
custom_proxy_group=👆🏻指定`select`.*

custom_proxy_group=🛩️墙内`select`[]DIRECT`[]✈️起飞
custom_proxy_group=💩广告`select`[]REJECT`[]DIRECT`[]✈️起飞

custom_proxy_group=📺B站`select`[]🛩️墙内`[]DIRECT`[]🇭🇰香港`[]🇹🇼台湾
custom_proxy_group=🎬流媒体`select`[]✈️起飞`[]🇭🇰香港`[]🇹🇼台湾`[]🇸🇬新加坡`[]🇯🇵日本`[]🇺🇸美国`[]🎏其他`[]👆🏻指定
custom_proxy_group=🎬Netflix`select`[]🎬流媒体`[]✈️起飞`[]🇸🇬新加坡`[]🇭🇰香港`[]🇹🇼台湾`[]🇯🇵日本`[]🇺🇸美国`[]🎏其他
custom_proxy_group=🎬YouTube`select`[]🎬流媒体`[]✈️起飞`[]🇸🇬新加坡`[]🇭🇰香港`[]🇹🇼台湾`[]🇯🇵日本`[]🇺🇸美国
custom_proxy_group=📲社交媒体`select`[]✈️起飞`[]🇸🇬新加坡`[]🇭🇰香港`[]🇹🇼台湾`[]🇯🇵日本`[]🇺🇸美国`[]🎏其他`[]👆🏻指定
custom_proxy_group=📱电报`select`[]✈️起飞`[]🇸🇬新加坡`[]🇭🇰香港`[]🇹🇼台湾`[]🇯🇵日本`[]🇺🇸美国`[]🎏其他`[]👆🏻指定

custom_proxy_group=🤖AI`select`[]🇺🇸美国`[]🇹🇼台湾`[]🇸🇬新加坡`[]🇯🇵日本`[]✈️起飞`[]👆🏻指定
custom_proxy_group=🎮游戏平台`select`[]✈️起飞`[]DIRECT`[]🇺🇸美国`[]🇭🇰香港`[]🇹🇼台湾`[]🇸🇬新加坡`[]🇯🇵日本`[]🎏其他
custom_proxy_group=🛡️Google服务`select`[]✈️起飞`[]🇸🇬新加坡`[]🇭🇰香港`[]🇹🇼台湾`[]🇯🇵日本`[]🇺🇸美国`[]🎏其他`[]DIRECT
custom_proxy_group=Ⓜ️微软服务`select`[]DIRECT`[]✈️起飞`[]🇺🇸美国`[]🇭🇰香港`[]🇹🇼台湾`[]🇸🇬新加坡`[]🇯🇵日本
custom_proxy_group=🍎苹果服务`select`[]DIRECT`[]✈️起飞`[]🇺🇸美国`[]🇭🇰香港`[]🇹🇼台湾`[]🇸🇬新加坡`[]🇯🇵日本
custom_proxy_group=🟢Spotify`select`[]✈️起飞`[]🇺🇸美国`[]🇭🇰香港`[]🇹🇼台湾`[]🇸🇬新加坡`[]🇯🇵日本`[]DIRECT`[]🎏其他
custom_proxy_group=📧邮件服务`select`[]✈️起飞`[]DIRECT`[]🇺🇸美国`[]🇸🇬新加坡`[]🎏其他
custom_proxy_group=🔎搜索引擎`select`[]✈️起飞`[]🇺🇸美国`[]🇭🇰香港`[]🇹🇼台湾`[]🇸🇬新加坡`[]🇯🇵日本`[]DIRECT
custom_proxy_group=🐟漏网之鱼`select`[]✈️起飞`[]🛩️墙内`[]💩广告`[]DIRECT`[]👆🏻指定

custom_proxy_group=🇭🇰香港`url-test`(?i)港|hongkong|hk`https://www.gstatic.com/generate_204`300,,50
custom_proxy_group=🇹🇼台湾`url-test`(?i)台|taiwan|tw`https://www.gstatic.com/generate_204`300,,50
custom_proxy_group=🇸🇬新加坡`url-test`(?i)新|singapore|sg`https://www.gstatic.com/generate_204`300,,50
custom_proxy_group=🇯🇵日本`url-test`(?i)日|japan|jp`https://www.gstatic.com/generate_204`300,,50
custom_proxy_group=🇺🇸美国`url-test`(?i)美|states|us`https://www.gstatic.com/generate_204`300,,150
custom_proxy_group=🎏其他`url-test`^(?!.*(港|台|新|日|美|hongkong|hk|taiwan|tw|singapore|sg|japan|jp|states|us)).*$`https://www.gstatic.com/generate_204`300,,100

# 广告规则优先匹配
ruleset=💩广告,clash-domain:https://anti-ad.net/clash.yaml
ruleset=💩广告,https://raw.githubusercontent.com/blackmatrix7/ios_rule_script/master/rule/Clash/AdvertisingLite/AdvertisingLite.list
ruleset=DIRECT,clash-classic:https://raw.githubusercontent.com/blackmatrix7/ios_rule_script/master/rule/Clash/Direct/Direct.list

# 优先匹配特定应用和服务
ruleset=📱电报,https://raw.githubusercontent.com/Loyalsoldier/clash-rules/master/telegramcidr.txt
ruleset=📱电报,https://raw.githubusercontent.com/blackmatrix7/ios_rule_script/master/rule/Clash/Telegram/Telegram.list

# AI服务
ruleset=🤖AI,https://raw.githubusercontent.com/blackmatrix7/ios_rule_script/master/rule/Clash/OpenAI/OpenAI.list
ruleset=🤖AI,https://raw.githubusercontent.com/blackmatrix7/ios_rule_script/master/rule/Clash/Claude/Claude.list
ruleset=🤖AI,https://raw.githubusercontent.com/blackmatrix7/ios_rule_script/master/rule/Clash/Gemini/Gemini.list
ruleset=🤖AI,https://raw.githubusercontent.com/blackmatrix7/ios_rule_script/master/rule/Clash/Anthropic/Anthropic.list
ruleset=🤖AI,https://raw.githubusercontent.com/blackmatrix7/ios_rule_script/master/rule/Clash/Perplexity/Perplexity.list

# 国内流媒体
ruleset=📺B站,https://raw.githubusercontent.com/blackmatrix7/ios_rule_script/master/rule/Clash/BiliBiliIntl/BiliBiliIntl.list
ruleset=📺B站,https://raw.githubusercontent.com/blackmatrix7/ios_rule_script/master/rule/Clash/BiliBili/BiliBili.list

# 国外流媒体
ruleset=🎬Netflix,https://raw.githubusercontent.com/blackmatrix7/ios_rule_script/master/rule/Clash/Netflix/Netflix.list
ruleset=🎬YouTube,https://raw.githubusercontent.com/blackmatrix7/ios_rule_script/master/rule/Clash/YouTube/YouTube.list
ruleset=🎬YouTube,https://raw.githubusercontent.com/blackmatrix7/ios_rule_script/master/rule/Clash/YouTubeMusic/YouTubeMusic.list
ruleset=🟢Spotify,https://raw.githubusercontent.com/blackmatrix7/ios_rule_script/master/rule/Clash/Spotify/Spotify.list
ruleset=🎬流媒体,https://raw.githubusercontent.com/blackmatrix7/ios_rule_script/master/rule/Clash/GlobalMedia/GlobalMedia.list

# 主要服务提供商
ruleset=🛡️Google服务,https://raw.githubusercontent.com/blackmatrix7/ios_rule_script/master/rule/Clash/Google/Google.list
ruleset=🍎苹果服务,https://raw.githubusercontent.com/blackmatrix7/ios_rule_script/master/rule/Clash/Apple/Apple.list
ruleset=Ⓜ️微软服务,https://raw.githubusercontent.com/blackmatrix7/ios_rule_script/master/rule/Clash/Microsoft/Microsoft.list
ruleset=Ⓜ️微软服务,https://raw.githubusercontent.com/blackmatrix7/ios_rule_script/master/rule/Clash/Bing/Bing.list
ruleset=📧邮件服务,https://raw.githubusercontent.com/blackmatrix7/ios_rule_script/master/rule/Clash/Mail/Mail.list

# 开发相关
ruleset=✈️起飞,https://raw.githubusercontent.com/blackmatrix7/ios_rule_script/master/rule/Clash/GitHub/GitHub.list
ruleset=✈️起飞,https://raw.githubusercontent.com/blackmatrix7/ios_rule_script/master/rule/Clash/GitLab/GitLab.list
ruleset=✈️起飞,https://raw.githubusercontent.com/blackmatrix7/ios_rule_script/master/rule/Clash/Developer/Developer.list

# 游戏和搜索
ruleset=🎮游戏平台,https://raw.githubusercontent.com/blackmatrix7/ios_rule_script/master/rule/Clash/Game/Game.list
ruleset=🔎搜索引擎,https://raw.githubusercontent.com/blackmatrix7/ios_rule_script/master/rule/Clash/SearchEngine/SearchEngine.list

# 社交媒体（电报已单独列出，避免重复）
ruleset=📲社交媒体,https://raw.githubusercontent.com/blackmatrix7/ios_rule_script/master/rule/Clash/Twitter/Twitter.list
ruleset=📲社交媒体,https://raw.githubusercontent.com/blackmatrix7/ios_rule_script/master/rule/Clash/Instagram/Instagram.list
ruleset=📲社交媒体,https://raw.githubusercontent.com/blackmatrix7/ios_rule_script/master/rule/Clash/Discord/Discord.list
ruleset=📲社交媒体,https://raw.githubusercontent.com/blackmatrix7/ios_rule_script/master/rule/Clash/Tiktok/Tiktok.list

# 协作工具
ruleset=✈️起飞,https://raw.githubusercontent.com/blackmatrix7/ios_rule_script/master/rule/Clash/Slack/Slack.list
ruleset=✈️起飞,https://raw.githubusercontent.com/blackmatrix7/ios_rule_script/master/rule/Clash/Zoom/Zoom.list
ruleset=✈️起飞,https://raw.githubusercontent.com/blackmatrix7/ios_rule_script/master/rule/Clash/Notion/Notion.list

# 国内直连
ruleset=🛩️墙内,https://raw.githubusercontent.com/blackmatrix7/ios_rule_script/master/rule/Clash/Mainland/Mainland.list
ruleset=🛩️墙内,https://raw.githubusercontent.com/blackmatrix7/ios_rule_script/master/rule/Clash/ChinaMedia/ChinaMedia.list
ruleset=🛩️墙内,https://raw.githubusercontent.com/blackmatrix7/ios_rule_script/master/rule/Clash/SteamCN/SteamCN.list
ruleset=🛩️墙内,https://raw.githubusercontent.com/blackmatrix7/ios_rule_script/master/rule/Clash/WeChat/WeChat.list
ruleset=🛩️墙内,https://raw.githubusercontent.com/blackmatrix7/ios_rule_script/master/rule/Clash/Tencent/Tencent.list
ruleset=🛩️墙内,https://raw.githubusercontent.com/blackmatrix7/ios_rule_script/master/rule/Clash/Alibaba/Alibaba.list
ruleset=🛩️墙内,https://raw.githubusercontent.com/blackmatrix7/ios_rule_script/master/rule/Clash/ByteDance/ByteDance.list
ruleset=🛩️墙内,https://raw.githubusercontent.com/blackmatrix7/ios_rule_script/master/rule/Clash/China/China.list
ruleset=🛩️墙内,https://raw.githubusercontent.com/blackmatrix7/ios_rule_script/master/rule/Clash/ChinaIPs/ChinaIPs.list
ruleset=🛩️墙内,https://raw.githubusercontent.com/Loyalsoldier/clash-rules/master/direct.txt
ruleset=🛩️墙内,https://raw.githubusercontent.com/Loyalsoldier/clash-rules/master/cncidr.txt
ruleset=🛩️墙内,[]GEOIP,CN,no-resolve

# 国外网站
ruleset=✈️起飞,https://raw.githubusercontent.com/Loyalsoldier/clash-rules/master/proxy.txt
ruleset=✈️起飞,https://raw.githubusercontent.com/blackmatrix7/ios_rule_script/master/rule/Clash/Global/Global.list

# 兜底规则
ruleset=🐟漏网之鱼,[]FINAL

# Clash核心配置
mixed-port: 10808
allow-lan: true
bind-address: '*'
mode: rule
log-level: warning
ipv6: false
external-controller: 127.0.0.1:9090
external-ui: dashboard
secret: ""

# TUN模式配置
tun:
  enable: true
  stack: gvisor
  dns-hijack:
    - any:53
    - tcp://any:53
  auto-route: true
  auto-detect-interface: true
  mtu: 1400
  tcp-balance: true
  udp-balance: true
  stack-buffer: 4096
  endpoint-independent-nat: true
  bypass:
    - 127.0.0.1/8
    - 169.254.0.0/16
    - 192.168.0.0/16
    - 10.0.0.0/8
    - 172.16.0.0/12
    - 192.0.0.0/24
    - 224.0.0.0/24
    - ::1/128
    - fc00::/7
    - fe80::/10
    - fd00::/8

  # 移动设备优化参数
  mobile-settings:
    # 移动网络下更小的MTU减少重传
    mobile-mtu: 1280
    # 漫游状态下最小MTU
    roaming-mtu: 1024
    # 低电量时禁用部分功能
    low-battery-optimizations: true

# DNS配置
dns:
  enable: true
  ipv6: false
  listen: 0.0.0.0:53
  enhanced-mode: fake-ip
  fake-ip-range: 198.18.0.1/16
  use-hosts: true
  preload-domain: true
  nameserver-cache-size: 4096
  prefer-h3: true

  # 默认DNS服务器，用于解析其他DNS服务器的域名
  default-nameserver:
    - 223.6.6.6      # 阿里DNS
    - 119.29.29.29   # 腾讯DNS
    - 114.114.114.114 # 114DNS
    - 8.8.8.8        # Google DNS备用

  # 主要DNS服务器 - 优先使用国内DNS以提高性能
  nameserver:
    - https://dns.alidns.com/dns-query # 阿里DOH
    - https://doh.pub/dns-query        # 腾讯DOH
    - 223.6.6.6                        # 阿里DNS，用于不支持DOH的情况
    - 119.29.29.29                     # 腾讯DNS，用于不支持DOH的情况

  # 国外回落DNS服务器 - 当nameserver无法解析或匹配到国外域名时使用
  fallback:
    - https://dns.google/dns-query        # Google DOH
    - https://cloudflare-dns.com/dns-query # Cloudflare DOH
    - https://doh.opendns.com/dns-query    # OpenDNS DOH
    - https://dns.quad9.net/dns-query      # Quad9 DOH

  # 代理模式下默认使用的DNS
  proxy-server-nameserver:
    - https://dns.google/dns-query         # Google DOH
    - https://cloudflare-dns.com/dns-query  # Cloudflare DOH

  # 域名解析策略 - 根据域名类型选择不同的DNS服务器
  nameserver-policy:
    # 国内网站优先使用国内DNS
    'geosite:cn,category-games-cn': [https://dns.alidns.com/dns-query, https://doh.pub/dns-query]
    # 微软中国和苹果中国服务
    'geosite:microsoft-cn,apple-cn': [https://dns.alidns.com/dns-query, https://doh.pub/dns-query]
    # 国外网站优先使用国外DNS
    'geosite:geolocation-!cn': [https://dns.cloudflare.com/dns-query, https://dns.google/dns-query]
    # 科学上网和开发网站
    'geosite:category-dev,category-science': [https://dns.cloudflare.com/dns-query, https://dns.google/dns-query]
    # 广告域名使用特定DNS，有助于广告拦截
    'geosite:category-ads-all': [https://dns.alidns.com/dns-query]
    # 银行、支付和金融服务优先使用国内DNS确保安全
    'geosite:category-finance': [https://dns.alidns.com/dns-query, 119.29.29.29]
    # 微软服务
    'domain:office.com,domain:office365.com,domain:sharepoint.com,domain:microsoft.com': [https://dns.quad9.net/dns-query, https://dns.cloudflare.com/dns-query]
    # 社交媒体
    'domain:twitter.com,domain:instagram.com,domain:facebook.com,domain:whatsapp.com': [https://dns.google/dns-query]
    # GitHub和开发相关
    'domain:github.com,domain:githubusercontent.com,domain:ghcr.io,domain:githubassets.com': [https://cloudflare-dns.com/dns-query, https://dns.google/dns-query]
    # CDN优化
    'domain:cdn.jsdelivr.net': [https://doh.pub/dns-query, https://dns.alidns.com/dns-query]
    'domain:fastly.net': [https://doh.pub/dns-query]
    'domain:akamaiedge.net': [https://dns.alidns.com/dns-query]
    'domain:cloudfront.net': [https://dns.google/dns-query]
    # 流媒体服务
    'domain:netflix.com,domain:nflxvideo.net,domain:nflxso.net,domain:nflxext.com': [https://dns.google/dns-query, https://cloudflare-dns.com/dns-query]
    'domain:youtube.com,domain:googlevideo.com,domain:ytimg.com': [https://dns.google/dns-query, https://cloudflare-dns.com/dns-query]
    # AI服务
    'domain:openai.com,domain:anthropic.com,domain:claude.ai,domain:suno.ai,domain:perplexity.ai': [https://dns.google/dns-query, https://cloudflare-dns.com/dns-query]

  # 域名TTL设置 - 增加常用域名缓存时间，减少DNS请求
  domain-ttl:
    'apple.com': 3600
    'microsoft.com': 3600
    'qq.com': 3600
    'taobao.com': 3600
    'baidu.com': 3600
    'jd.com': 3600
    'google.com': 3600
    'youtube.com': 3600
    'netflix.com': 3600
    'github.com': 3600
    'cloudflare.com': 3600
    'openai.com': 3600
    'alipay.com': 1800
    'weixin.qq.com': 1800
    'zhihu.com': 1800
    'bilibili.com': 1800

  # 特定域名主机地址
  hosts:
    'mtalk.google.com': 108.177.125.188
    'dl.google.com': 142.250.4.132
    'mobile-gtalk.l.google.com': 108.177.125.188

  # Fake-IP过滤器 - 防止特定域名使用fake-ip模式，避免DNS泄露和连接问题
  fake-ip-filter:
    # 基本网络服务
    - '*.lan'
    - '*.local'
    - 'local'
    - '*.localhost'
    - 'localhost'
    - '*.localdomain'
    - '*.example'
    - '*.invalid'
    - '*.test'

    # WebRTC STUN服务器
    - 'stun.*.*.*'
    - 'stun.*.*'
    - '*.stun.*.*'
    - '*.stun.*'
    - '*.stun.*.*.*'

    # Microsoft连接测试
    - '*.msftncsi.com'
    - '*.msftconnecttest.com'
    - 'msftncsi.com'
    - 'msftconnecttest.com'

    # 本地域名
    - '*.home.arpa'

    # 时间服务器
    - 'time.*.com'
    - 'time.*.gov'
    - 'time.*.apple.com'
    - 'time1.*.com'
    - 'time2.*.com'
    - 'time3.*.com'
    - 'time4.*.com'
    - 'time5.*.com'
    - 'time6.*.com'
    - 'time7.*.com'
    - 'ntp.*.com'
    - 'ntp1.*.com'
    - 'ntp2.*.com'
    - 'ntp3.*.com'
    - 'ntp4.*.com'
    - 'ntp5.*.com'
    - 'ntp6.*.com'
    - 'ntp7.*.com'
    - 'time.windows.com'
    - '*.pool.ntp.org'

    # P2P 种子和追踪器
    - 'tracker.*.*'
    - '*.tracker.*'
    - 'seed.*.*'
    - '*.seed.*'
    - '*.torrent.*'
    - 'torrent.*.*'

    # 无线网络验证
    - 'captive.apple.com'
    - 'connectivitycheck.gstatic.com'
    - 'connectivitycheck.android.com'
    - 'detectportal.firefox.com'

    # 信用卡和支付系统
    - '*.alipay.com'
    - '*.pay.*.com'
    - '*.creditcard.*.com'
    - '*.paypal.com'
    - '*.stripe.com'

    # 银行和金融机构
    - '*.bank.*.com'
    - '*.banking.*.com'

    # 内网保留地址(防止DNS泄露)
    - '+.internal'
    - '+.my.router'
    - '+.router.asus.com'
    - '+.network'

  # 移动网络DNS策略
  mobile-dns-strategy:
    # 移动网络下使用非DoH DNS以节省资源
    prefer-standard-dns: true
    # 延长缓存时间
    cache-ttl-multiplier: 2
    # 漫游下最小化DNS查询
    minimal-resolving-under-roaming: true
    # 低电量时限制DNS操作
    reduce-operations-on-low-battery: true

  # 网络感知DNS
  network-specific-nameserver:
    wifi:
      - https://dns.alidns.com/dns-query
      - https://doh.pub/dns-query
    mobile:
      - 223.6.6.6
      - 119.29.29.29
    roaming:
      - 223.6.6.6

# 性能优化配置
tcp-concurrent: true
tcp-concurrent-max: 512
tcp-concurrent-reuse: true
tcp-fast-open-queue: 512
tcp-no-delay: true
inbound-tfo: true
outbound-tfo: true
inbound-buffer-size: 8192
outbound-buffer-size: 8192
buffer-size: 16384

connection-timeout: 5
dial-timeout: 3
keep-alive-interval: 30
find-process-refresh-interval: 30
disable-logger: true

auto-reconnect: true
reconnect-interval: 3

# 缓存配置
cache:
  enable: true
  size: 8192
  ttl: 3600
  store-fakeip: true
  persistence: true
  memory-ratio: 0.2
  disk-ratio: 0.8
  optimistic-dns: true

  # 移动网络下的策略
  mobile-strategy:
    # 增加缓存时间以减少网络请求
    extended-ttl: true
    # 优先缓存频繁访问的资源
    prioritize-frequent: true
    # 根据网络类型自动调整缓存大小
    adaptive-sizing: true
    # 低电量时最大化使用缓存
    maximize-on-low-battery: true

rule-cache:
  enable: true
  size: 10240
  ttl: 7200

# 嗅探配置
sniff:
  enable: true
  override-destination: true
  parse-pure-ip: true
  force-domain: true
  skip-domain:
    - '*.alipay.com'
    - '*.pay.*.com'

sniffer:
  enable: true
  sniff:
    http: true
    tls: true
    quic: true
    mtls: true
  force-domain: true
  skip-domain:
    - 'Mijia Cloud'
    - 'dlg.io.mi.com'
    - '*.alipay.com'
    - '*.weixin.qq.com'
    - '*.pay.*.com'
  port-whitelist:
    - 80
    - 443
    - 8000-9000
  sniffing-timeout: 200

# 高级配置
profile:
  store-selected: true
  store-fake-ip: true
  tracing: false

wifi-ssid-switch:
  enable: true
  default: "DIRECT"
  ssid:
    "home-wifi": "DEFAULT"
    "work-wifi": "PROXY"
    "pay-wifi": "DIRECT"

battery-saver:
  enable: true
  threshold: 20
  save-mode:
    tcp-concurrent: false
    keep-alive-interval: 60
    sniff: selective

memory:
  optimize-for: speed
  gc-interval: 300
  max-log-size: 1

low-latency-mode:
  enable: true
  handshake-timeout: 3
  socket-buffer-size: 16384

mobile-optimization:
  enable: true
  wake-lock: selective
  reduce-background-traffic: true
  prioritize-interactive-traffic: true
  adaptive-network: true

network-profiles:
  wifi:
    buffer-size: 32768
    tcp-concurrent: true
    keep-alive-interval: 15
    dns-prefetch: aggressive
    max-connections: 256
    idle-timeout: 300
  mobile:
    buffer-size: 8192
    tcp-concurrent: selective
    keep-alive-interval: 45
    dns-prefetch: conservative
    max-connections: 128
    idle-timeout: 180
  roaming:
    buffer-size: 4096
    tcp-concurrent: false
    keep-alive-interval: 90
    dns-prefetch: disabled
    max-connections: 64
    idle-timeout: 60

traffic-control:
  enable: true
  mobile-data-compression: true
  roaming-compression: true
  low-battery-control: true
  priorities:
    foreground: high
    background: low

quic:
  enable: true
  max-idle-timeout: 30
  keep-alive-interval: 15
  0-rtt: true

network-profiles:
  wifi:
    buffer-size: 32768
    tcp-concurrent: true
    keep-alive-interval: 15
    dns-prefetch: aggressive
  mobile:
    buffer-size: 8192
    tcp-concurrent: selective
    keep-alive-interval: 45
    dns-prefetch: conservative
  roaming:
    buffer-size: 4096
    tcp-concurrent: false
    keep-alive-interval: 60
    dns-prefetch: disabled

geodata-mode: true
geodata-loader: standard
global-client-fingerprint: chrome
find-process-mode: always

internet-test-url: http://www.gstatic.com/generate_204
proxy-test-url: http://cp.cloudflare.com/generate_204
test-timeout: 5

experimental:
  ignore-resolve-fail: true
  routing-mark: 255
  clash-for-android:
    append-system-dns: false
    ui-delay-connect: true
    battery-optimizations: true
    smooth-network-switching: true
    optimized-notifications: true
    pause-during-doze: true
  quic-receive-window: 16777216
  bbr: true
  optimistic-connection: true
  compression: true

  mobile-optimizations:
    smart-vpn-pause: true
    app-usage-awareness: true
    network-quality-adaptation: true
    auto-downgrade-on-low-battery: true
    data-saving-compression: true

url-test:
  mobile-test-interval: 600
  roaming-test-interval: 1800
  low-battery-test-interval: 900
  timeout: 3

connection-manager:
  adaptive-parameters: true
  auto-close-idle:
    wifi: 300
    mobile: 180
    roaming: 60
    low-battery: 30
  on-network-change:
    smooth-transition: true
    reassess-connections: true
    prioritize-essential: true
